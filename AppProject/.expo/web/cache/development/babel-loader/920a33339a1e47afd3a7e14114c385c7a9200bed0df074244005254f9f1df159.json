{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport { FAB } from 'react-native-paper';\nimport React, { useState, useRef } from 'react';\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Button from \"react-native-web/dist/exports/Button\";\nimport { Audio } from 'expo-av';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nfunction Home(props) {\n  var pushAudio = function pushAudio(url) {\n    var formData = new FormData();\n    formData.append('file', {\n      uri: url,\n      type: 'audio/m4a',\n      name: 'audiofile.m4a'\n    });\n    fetch('https://text-it.onrender.com/uploadaudio', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'multipart/form-data'\n      },\n      body: formData\n    }).then(function (resp) {\n      return resp.json();\n    }).then(props.navigation.navigate('Results')).catch(function (error) {\n      return console.log(error);\n    });\n  };\n  var _React$useState = React.useState(),\n    _React$useState2 = _slicedToArray(_React$useState, 2),\n    recording = _React$useState2[0],\n    setRecording = _React$useState2[1];\n  function startRecording() {\n    return _startRecording.apply(this, arguments);\n  }\n  function _startRecording() {\n    _startRecording = _asyncToGenerator(function* () {\n      try {\n        console.log('Requesting permissions..');\n        yield Audio.requestPermissionsAsync();\n        yield Audio.setAudioModeAsync({\n          allowsRecordingIOS: true,\n          playsInSilentModeIOS: true\n        });\n        console.log('Starting recording...');\n        startTimer();\n        var _yield$Audio$Recordin = yield Audio.Recording.createAsync(Audio.RecordingOptionsPresets.HIGH_QUALITY),\n          _recording = _yield$Audio$Recordin.recording;\n        setRecording(_recording);\n        console.log('Recording started');\n      } catch (err) {\n        console.error('Failed to start recording', err);\n      }\n    });\n    return _startRecording.apply(this, arguments);\n  }\n  function stopRecording() {\n    return _stopRecording.apply(this, arguments);\n  }\n  function _stopRecording() {\n    _stopRecording = _asyncToGenerator(function* () {\n      console.log('Stopping recording..');\n      stopTimer();\n      setRecording(undefined);\n      yield recording.stopAndUnloadAsync();\n      yield Audio.setAudioModeAsync({\n        allowsRecordingIOS: false\n      });\n      var uri = recording.getURI();\n      pushAudio(uri);\n      console.log('Recording stopped and stored at', uri);\n    });\n    return _stopRecording.apply(this, arguments);\n  }\n  var _useState = useState(0),\n    _useState2 = _slicedToArray(_useState, 2),\n    time = _useState2[0],\n    setTime = _useState2[1];\n  var intervalRef = useRef(null);\n  var startTimer = function startTimer() {\n    if (intervalRef.current !== null) return;\n    intervalRef.current = setInterval(function () {\n      setTime(function (prevTime) {\n        return prevTime + 1;\n      });\n    }, 100);\n  };\n  var stopTimer = function stopTimer() {\n    if (intervalRef.current === null) return;\n    clearInterval(intervalRef.current);\n    intervalRef.current = null;\n  };\n  var resetTimer = function resetTimer() {\n    stopTimer();\n    setTime(0);\n  };\n  var formatTime = function formatTime(time) {\n    return Math.floor(time / 10 / 60) % 60 + \" : \" + Math.floor(time / 10) % 60 + \" : \" + time % 10;\n  };\n  return _jsxs(View, {\n    style: {\n      flex: 1\n    },\n    children: [_jsx(Button, {\n      title: recording ? 'Stop Recording' : 'Start Recording',\n      onPress: recording ? stopRecording : startRecording\n    }), _jsxs(View, {\n      style: {\n        flex: 1,\n        justifyContent: 'center',\n        alignItems: 'center'\n      },\n      children: [_jsx(Text, {\n        style: {\n          fontSize: 32\n        },\n        children: formatTime(time)\n      }), _jsx(View, {\n        style: {\n          flexDirection: 'row'\n        },\n        children: _jsx(Button, {\n          title: \"Reset\",\n          onPress: resetTimer\n        })\n      })]\n    }), _jsx(FAB, {\n      style: styles.fab,\n      small: false,\n      icon: \"plus\",\n      theme: {\n        colors: {\n          accent: \"green\"\n        }\n      },\n      onPress: function onPress() {\n        return props.navigation.navigate('Results');\n      }\n    })]\n  });\n}\nvar styles = StyleSheet.create({\n  fab: {\n    position: 'absolute',\n    margin: 16,\n    right: 0,\n    bottom: 100\n  }\n});\nexport default Home;","map":{"version":3,"names":["FAB","React","useState","useRef","Text","View","StyleSheet","Button","Audio","jsx","_jsx","jsxs","_jsxs","Home","props","pushAudio","url","formData","FormData","append","uri","type","name","fetch","method","headers","body","then","resp","json","navigation","navigate","catch","error","console","log","_React$useState","_React$useState2","_slicedToArray","recording","setRecording","startRecording","_startRecording","apply","arguments","_asyncToGenerator","requestPermissionsAsync","setAudioModeAsync","allowsRecordingIOS","playsInSilentModeIOS","startTimer","_yield$Audio$Recordin","Recording","createAsync","RecordingOptionsPresets","HIGH_QUALITY","err","stopRecording","_stopRecording","stopTimer","undefined","stopAndUnloadAsync","getURI","_useState","_useState2","time","setTime","intervalRef","current","setInterval","prevTime","clearInterval","resetTimer","formatTime","Math","floor","style","flex","children","title","onPress","justifyContent","alignItems","fontSize","flexDirection","styles","fab","small","icon","theme","colors","accent","create","position","margin","right","bottom"],"sources":["F:/projectXapp/appproject/components/Home.js"],"sourcesContent":["/*\r\nimport React, {useState, useEffect} from 'react'\r\nimport {Audio} from 'expo-av';\r\nimport {View, Text, StyleSheet} from 'react-native'\r\nimport { Button } from 'react-native-paper';\r\n\r\nfunction Home(){\r\n    const [recording, setRecording] = React.useState();\r\n    const [recordings, setRecordings] = React.useState([]);\r\n    const [message, setMessage] = React.useState(\"\");\r\n\r\n    async function startRecording(){\r\n        try{\r\n            const permission = await Audio.requestPermissionAsync();\r\n\r\n            if(permission.status === \"granted\"){\r\n                await Audio.setAudioModeAsync({\r\n                    allowsRecordingIOS: true,\r\n                    playsInSilentModeIOS: true\r\n                });\r\n\r\n                const{recording} = await Audio.Recording.createAsync(\r\n                    Auido.RECORDING_OPTIONS_PRESET_HIGH_QUALITY\r\n                );\r\n\r\n                setRecording(recording)\r\n            }else{\r\n                setMessage('Please grant permission')\r\n            }\r\n        } catch(err){\r\n            console.error('Failed to start recording', err)\r\n        }\r\n    }\r\n\r\n    async function stopRecording(){\r\n        setRecording(undefined);\r\n        await recording.stopAndUnloadAsync();\r\n\r\n        let updateRecordings = [...recordings];\r\n        const {sound, status} = await recording.createNewLoadedSoundAsync();\r\n        updateRecordings.push({\r\n            sound:sound,\r\n            duration: getDurationFormatted(status.durationMillis),\r\n            file: recording.getURI()\r\n        });\r\n        \r\n        setRecordings(updateRecordings)\r\n    }\r\n\r\n    function getDurationFormatted(millis){\r\n        const minutes = millis / 1000 / 60;\r\n        const minutesDisplay = Math.floor(minutes);\r\n        const seconds = Math.round((minutes - minutesDisplay) * 60);\r\n        const secondsDisplay = seconds < 10 ? `0${seconds}` : seconds;\r\n\r\n        return `${minutesDisplay}:${secondsDisplay}`;\r\n    }\r\n\r\n    return(\r\n        <View>\r\n            <Text>{message}</Text>\r\n            <Button\r\n                onPress={recording ? stopRecording() : startRecording()}\r\n                mode = \"contained\"\r\n            >{recording ? \"Stop\" : \"Start\"}</Button>            \r\n        </View>        \r\n    )\r\n}\r\n\r\nexport default Home\r\n*/\r\n\r\nimport { FAB} from 'react-native-paper'\r\n\r\nimport React, { useState, useRef } from 'react';\r\nimport { Text, View, StyleSheet, Button } from 'react-native';\r\nimport { Audio } from 'expo-av';\r\n// import Timer from './Timer';\r\n\r\nfunction Home(props) {\r\n    const pushAudio = (url) =>{        \r\n        const formData = new FormData();\r\n        formData.append('file',{\r\n            uri: url,\r\n            type: 'audio/m4a',\r\n            name: 'audiofile.m4a'            \r\n        })    \r\n\r\n        fetch(\r\n            //'http://192.168.3.2:3000/uploadaudio',\r\n            'https://text-it.onrender.com/uploadaudio',\r\n            {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Content-Type':'multipart/form-data'\r\n                },\r\n                body: formData\r\n            })\r\n            .then(resp => resp.json())\r\n            .then(props.navigation.navigate('Results'))\r\n            .catch(error => console.log(error)\r\n        )\r\n    }\r\n\r\n\r\n    const [recording, setRecording] = React.useState();\r\n\r\n    async function startRecording() {\r\n        try {\r\n        console.log('Requesting permissions..');\r\n        await Audio.requestPermissionsAsync();\r\n        await Audio.setAudioModeAsync({\r\n            allowsRecordingIOS: true,\r\n            playsInSilentModeIOS: true,\r\n        });\r\n        \r\n        console.log('Starting recording...');\r\n        startTimer(); //Функция для компонента Timer\r\n\r\n        const { recording } = await Audio.Recording.createAsync( Audio.RecordingOptionsPresets.HIGH_QUALITY);\r\n        setRecording(recording);\r\n        console.log('Recording started');\r\n        } catch (err) {\r\n        console.error('Failed to start recording', err);\r\n        }\r\n    }\r\n\r\n    async function stopRecording() {\r\n        console.log('Stopping recording..');        \r\n        stopTimer(); //Функцияя для компонента Timer\r\n\r\n        setRecording(undefined);\r\n        await recording.stopAndUnloadAsync();\r\n        await Audio.setAudioModeAsync({\r\n        allowsRecordingIOS: false,\r\n        });\r\n        const uri = recording.getURI();\r\n        pushAudio(uri);\r\n        console.log('Recording stopped and stored at', uri);\r\n    }\r\n\r\n\r\n    // Логика для компонента Timer (пока он не подключен)\r\n    const [time, setTime] = useState(0);\r\n    const intervalRef = useRef(null);\r\n\r\n    const startTimer = () => {\r\n        if (intervalRef.current !== null) return;\r\n\r\n        intervalRef.current = setInterval(() => {\r\n            setTime(prevTime => prevTime + 1);\r\n        }, 100);\r\n    };\r\n\r\n    const stopTimer = () => {\r\n        if (intervalRef.current === null) return;\r\n\r\n        clearInterval(intervalRef.current);\r\n        intervalRef.current = null;\r\n    };\r\n\r\n    const resetTimer = () => {\r\n        stopTimer();\r\n        setTime(0);\r\n    };\r\n\r\n    const formatTime = (time) =>{\r\n        return `${Math.floor(time/10/60)%60} : ${Math.floor(time/10)%60} : ${time%10}`\r\n    }\r\n    // Конец логики для компонента Timer\r\n\r\n\r\n    return (\r\n        <View style={{flex:1}}>                   \r\n            <Button                                \r\n                title={recording ? 'Stop Recording' : 'Start Recording'}\r\n                onPress={recording ? stopRecording : startRecording}\r\n            />     \r\n\r\n            {/*HTML для компонента Timer (пока он не подключен)*/}\r\n            <View style={{flex: 1, justifyContent: 'center', alignItems: 'center'}}>\r\n                <Text style={{ fontSize: 32}}>{formatTime(time)}</Text>\r\n                <View style={{ flexDirection: 'row' }}>                \r\n                    <Button title=\"Reset\" onPress={resetTimer} />\r\n                </View>\r\n            </View>\r\n            {/* Конец HTML для компонента Timer*/}            \r\n\r\n            <FAB      \r\n                style = {styles.fab}      \r\n                small = {false}\r\n                icon = \"plus\"\r\n                theme = {{colors:{accent:\"green\"}}}\r\n                onPress = {() => props.navigation.navigate('Results')}\r\n            />  \r\n        </View>\r\n    );\r\n}\r\n\r\nconst styles = StyleSheet.create({    \r\n    fab:{\r\n        position:'absolute',\r\n        margin: 16,\r\n        right: 0,\r\n        bottom: 100\r\n    }\r\n})\r\n\r\nexport default Home;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}